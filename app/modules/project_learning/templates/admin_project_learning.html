<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <!-- ê¸°ê¸°ì— ë§ì¶°ì„œ ìµœì í™” í™”ë©´ ë„ˆë¹„ë¥¼ ë””ë°”ì´ìŠ¤ ë„ˆë¹„ë‘ ë™ì¼í•˜ê²Œ ì„¤ì •í•¨-->
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Project Modal - Tailwind CDN</title>

  <!-- Tailwind CDN (ê°œë°œìš©, ë¹ ë¥´ê²Œ ì‚¬ìš©) -->
  <script src="https://cdn.tailwindcss.com"></script>

  <style>
    /* ëª¨ë‹¬ ë ˆì´ì–´ ìŠ¤í¬ë¡¤ ë°©ì§€ìš© (ëª¨ë‹¬ open ì‹œ bodyì— .overflow-hidden ì¶”ê°€) */
    .no-scroll {
      overflow: hidden;
    }
    /* ê°„ë‹¨í•œ íƒ­ í™œì„±í™” ìŠ¤íƒ€ì¼(ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ active í´ë˜ìŠ¤ í† ê¸€) */
    .tab-trigger.active {
      background-color: white;
      border-bottom: 2px solid #4f46e5; /* indigo-600 */
      color: #1f2937; /* gray-800 */
    }
  </style>
</head>
<body class="bg-gray-100 min-h-screen p-6">

  <div class="max-w-4xl mx-auto">
    <h1 class="text-2xl font-bold mb-4">í”„ë¡œì íŠ¸ ëª¨ë‹¬ ë°ëª¨ (HTML + Tailwind CDN)</h1>

    <button id="openModalBtn" class="px-4 py-2 bg-indigo-600 text-white rounded hover:bg-indigo-700">
      ëª¨ë‹¬ ì—´ê¸°
    </button>
  </div>

  <!-- Modal (ì´ˆê¸° hidden) -->
  <div id="modal" class="fixed inset-0 z-50 hidden items-center justify-center">
    <!-- Overlay -->
    <div id="overlay" class="absolute inset-0 bg-gray-900/50" ></div>

    <!-- Dialog -->
    <div class="relative w-[90%] max-w-4xl max-h-[90vh] bg-white rounded-lg shadow-lg overflow-hidden">
      <!-- Header -->
      <div class="px-6 pt-6 pb-4 border-b">
        <div class="flex items-start justify-between">
          <h2 id="roomTopic" class="text-lg font-semibold">AI ì¡°ì‚¬ í”„ë¡œì íŠ¸</h2>
          <button id="closeBtn" class="text-gray-500 hover:text-gray-700">âœ•</button>
        </div>
      </div>

      <!-- Tabs + Content -->
      <div class="flex flex-col h-[70vh]">
        <!-- Tabs -->
        <div class="px-6 pt-4">
          <div class="grid grid-cols-2 gap-2 bg-gray-50 rounded-md p-1">
            <button class="tab-trigger py-2 text-sm font-medium rounded-md" data-tab="research">ì¡°ì‚¬ ë° ì—°êµ¬</button>
            <button class="tab-trigger py-2 text-sm font-medium rounded-md" data-tab="submission">ê²°ê³¼ë¬¼ ì œì¶œ</button>
          </div>
        </div>

        <!-- Tab contents -->
        <div class="px-6 pb-6 pt-4 flex-1 overflow-auto">
          <!-- Research Tab -->
          <div id="researchTab" class="tab-content space-y-6">
            <!-- Role Assignment -->
            <div class="space-y-3">
              <label class="text-gray-900">ì—­í•  ë°°ì •</label>
              <div class="flex items-center gap-2">
                <select id="roleSelect" class="border rounded px-3 py-2">
                  <option value="">ì—­í• ì„ ì„ íƒí•˜ì„¸ìš”</option>
                  <option>íŒ€ì¥</option>
                  <option>ì¡°ì‚¬ì›</option>
                  <option>ë¶„ì„ê°€</option>
                  <option>ë°œí‘œì</option>
                  <option>ê¸°ë¡ì</option>
                </select>
                <div id="currentRole" class="text-sm text-gray-600"></div>
              </div>
            </div>

            <hr />

            <!-- Research Input -->
            <div class="space-y-3">
              <label class="text-gray-900">ì¡°ì‚¬í•  ë‚´ìš©</label>
              <div class="flex gap-2">
                <input id="researchInput" class="flex-1 border rounded px-3 py-2" placeholder="ì¡°ì‚¬í•˜ê³  ì‹¶ì€ ë‚´ìš©ì„ ì…ë ¥í•˜ì„¸ìš”..." />
                <button id="researchBtn" class="px-4 py-2 bg-indigo-600 text-white rounded disabled:opacity-50">
                  <span id="researchBtnIcon">ğŸ”</span>
                </button>
              </div>
            </div>

            <!-- Research Results -->
            <div id="researchResultsWrap" class="space-y-3 hidden">
              <div class="flex items-center gap-2">
                <svg class="w-5 h-5 text-indigo-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 2v6l4 2"></path></svg>
                <label class="text-gray-900">AI ì¡°ì‚¬ ê²°ê³¼</label>
              </div>

              <div id="researchList" class="h-[400px] overflow-auto rounded-lg border bg-gray-50 p-4 space-y-4"></div>
            </div>

            <!-- Loading -->
            <div id="loading" class="flex items-center justify-center py-8 text-gray-500 hidden">
              <svg class="w-6 h-6 animate-spin mr-2" viewBox="0 0 24 24"><circle cx="12" cy="12" r="10" stroke="currentColor" stroke-width="4" stroke-linecap="round" fill="none"></circle></svg>
              <span>AIê°€ ì¡°ì‚¬ ì¤‘ì…ë‹ˆë‹¤...</span>
            </div>

            <div id="noResearch" class="text-center py-12 text-gray-500">
              <div class="mx-auto mb-3 text-4xl">ğŸ”</div>
              <p>ì¡°ì‚¬í•  ë‚´ìš©ì„ ì…ë ¥í•˜ê³  AIì˜ ë„ì›€ì„ ë°›ì•„ë³´ì„¸ìš”</p>
            </div>
          </div>

          <!-- Submission Tab -->
          <div id="submissionTab" class="tab-content hidden space-y-6">
            <div class="space-y-3">
              <label class="text-gray-900">ê²°ê³¼ë¬¼ ì‘ì„±</label>
              <textarea id="submissionTextarea" class="w-full min-h-[200px] border rounded p-3" placeholder="ì¡°ì‚¬ ë‚´ìš©ì„ ë°”íƒ•ìœ¼ë¡œ í”„ë¡œì íŠ¸ ê²°ê³¼ë¬¼ì„ ì‘ì„±í•˜ì„¸ìš”..."></textarea>
              <div class="flex justify-end">
                <button id="submitBtn" class="px-4 py-2 bg-green-600 text-white rounded disabled:opacity-50">ì œì¶œí•˜ê¸°</button>
              </div>
            </div>

            <div id="submissionsWrap" class="space-y-3 hidden">
              <div class="flex items-center gap-2">
                <svg class="w-5 h-5 text-green-600" viewBox="0 0 24 24" fill="none" stroke="currentColor"><path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 12l2 2 4-4"></path></svg>
                <label class="text-gray-900">ì œì¶œëœ ê²°ê³¼ë¬¼</label>
              </div>

              <div id="submissionList" class="h-[300px] overflow-auto rounded-lg border bg-gray-50 p-4 space-y-4"></div>
            </div>

            <div id="noSubmission" class="text-center py-12 text-gray-500">
              <div class="mx-auto mb-3 text-4xl">ğŸ“</div>
              <p>ì•„ì§ ì œì¶œëœ ê²°ê³¼ë¬¼ì´ ì—†ìŠµë‹ˆë‹¤</p>
              <p class="text-sm mt-1">ì¡°ì‚¬ ê²°ê³¼ë¥¼ ë°”íƒ•ìœ¼ë¡œ ê²°ê³¼ë¬¼ì„ ì‘ì„±í•´ë³´ì„¸ìš”</p>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

<script>
  /*********************
   * ì´ˆê¸° ë°ì´í„°/ìƒíƒœ
   *********************/
  const MOCK_AI_RESPONSES = [
    'ì¡°ì‚¬ ê²°ê³¼(ìš”ì•½): í˜„ì¬ ì¶”ì„¸ëŠ” ìƒìŠ¹ì„¸ì…ë‹ˆë‹¤. ì£¼ìš” ë°œê²¬: A, B, C.',
    'ìš”ì²­ ì£¼ì œì— ëŒ€í•œ ì •ë¦¬: ì—­ì‚¬, í˜„í™©, ì „ë§. ì¶”ê°€ ì¡°ì‚¬ê°€ í•„ìš”í•©ë‹ˆë‹¤.',
    'ìš”ì•½: ë°ì´í„° ë¶„ì„ ê²°ê³¼ ì¼ë¶€ ì§€í‘œ ìƒìŠ¹, ê¶Œì¥ì‚¬í•­: ì¶”ê°€ ì‚¬ë¡€ ì—°êµ¬ ìˆ˜í–‰.'
  ];

  // ìƒíƒœ
  let researches = [];
  let submissions = [];

  /*********************
   * DOM ìš”ì†Œ ì°¸ì¡°
   *********************/
  const openModalBtn = document.getElementById('openModalBtn');
  const modal = document.getElementById('modal');
  const overlay = document.getElementById('overlay');
  const closeBtn = document.getElementById('closeBtn');
  const tabTriggers = document.querySelectorAll('.tab-trigger');
  const researchTab = document.getElementById('researchTab');
  const submissionTab = document.getElementById('submissionTab');

  const roleSelect = document.getElementById('roleSelect');
  const currentRole = document.getElementById('currentRole');

  const researchInput = document.getElementById('researchInput');
  const researchBtn = document.getElementById('researchBtn');
  const researchList = document.getElementById('researchList');
  const researchResultsWrap = document.getElementById('researchResultsWrap');
  const loadingEl = document.getElementById('loading');
  const noResearch = document.getElementById('noResearch');

  const submissionTextarea = document.getElementById('submissionTextarea');
  const submitBtn = document.getElementById('submitBtn');
  const submissionList = document.getElementById('submissionList');
  const submissionsWrap = document.getElementById('submissionsWrap');
  const noSubmission = document.getElementById('noSubmission');

  /*********************
   * ëª¨ë‹¬ ì—´ê¸°/ë‹«ê¸°
   *********************/
  function openModal() {
    modal.classList.remove('hidden');
    document.body.classList.add('no-scroll');
    // ê¸°ë³¸ íƒ­ ì„¸íŒ…
    activateTab('research');
  }
  function closeModal() {
    modal.classList.add('hidden');
    document.body.classList.remove('no-scroll');
  }

  openModalBtn.addEventListener('click', openModal);
  closeBtn.addEventListener('click', closeModal);
  overlay.addEventListener('click', closeModal);

  /*********************
   * íƒ­ ê¸°ëŠ¥
   *********************/
  function activateTab(name) {
    tabTriggers.forEach(btn => {
      btn.classList.toggle('active', btn.dataset.tab === name);
    });

    if (name === 'research') {
      researchTab.classList.remove('hidden');
      submissionTab.classList.add('hidden');
    } else {
      researchTab.classList.add('hidden');
      submissionTab.classList.remove('hidden');
    }
  }

  tabTriggers.forEach(btn => {
    btn.addEventListener('click', () => activateTab(btn.dataset.tab));
  });

  /*********************
   * ì—­í•  ì„ íƒ
   *********************/
  roleSelect.addEventListener('change', () => {
    const v = roleSelect.value;
    currentRole.textContent = v ? `í˜„ì¬ ì—­í• : ${v}` : '';
  });

  /*********************
   * ì¡°ì‚¬ ê¸°ëŠ¥ (ëª¨ì˜ AI)
   *********************/
  function renderResearches() {
    researchList.innerHTML = '';
    if (researches.length === 0) {
      researchResultsWrap.classList.add('hidden');
      noResearch.classList.remove('hidden');
      return;
    }

    researchResultsWrap.classList.remove('hidden');
    noResearch.classList.add('hidden');

    researches.forEach(r => {
      const box = document.createElement('div');
      box.className = 'bg-white rounded-lg p-4 shadow-sm';
      box.innerHTML = `
        <div class="flex items-start justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-gray-500">ğŸ”</span>
            <span class="text-gray-900">${escapeHtml(r.query)}</span>
          </div>
          <span class="text-xs text-gray-500">${formatTime(r.timestamp)}</span>
        </div>
        <div class="pl-6 text-gray-700 whitespace-pre-line">${escapeHtml(r.result)}</div>
      `;
      researchList.appendChild(box);
    });
  }

  function handleResearch() {
    const q = researchInput.value.trim();
    if (!q) return;
    // ë¡œë”© ë³´ì—¬ì£¼ê¸°
    loadingEl.classList.remove('hidden');
    researchBtn.disabled = true;
    researchBtn.querySelector('#researchBtnIcon').textContent = 'â³';

    setTimeout(() => {
      const random = MOCK_AI_RESPONSES[Math.floor(Math.random() * MOCK_AI_RESPONSES.length)];
      const newResearch = { id: Date.now().toString(), query: q, result: random, timestamp: new Date() };
      researches.push(newResearch);
      researchInput.value = '';
      renderResearches();

      // ë¡œë”© ìˆ¨ê¸°ê¸°
      loadingEl.classList.add('hidden');
      researchBtn.disabled = false;
      researchBtn.querySelector('#researchBtnIcon').textContent = 'ğŸ”';
    }, 1200);
  }

  researchBtn.addEventListener('click', handleResearch);
  researchInput.addEventListener('keydown', (e) => {
    if (e.key === 'Enter') handleResearch();
  });

  /*********************
   * ì œì¶œ ê¸°ëŠ¥
   *********************/
  function renderSubmissions() {
    submissionList.innerHTML = '';
    if (submissions.length === 0) {
      submissionsWrap.classList.add('hidden');
      noSubmission.classList.remove('hidden');
      return;
    }

    submissionsWrap.classList.remove('hidden');
    noSubmission.classList.add('hidden');

    submissions.forEach(s => {
      const box = document.createElement('div');
      box.className = 'bg-white rounded-lg p-4 shadow-sm';
      box.innerHTML = `
        <div class="flex items-center justify-between mb-3">
          <div class="flex items-center gap-2">
            <span class="text-green-600">âœ…</span>
            <span class="text-sm text-gray-700">ì œì¶œ ì™„ë£Œ</span>
          </div>
          <span class="text-xs text-gray-500">${formatShortDate(s.timestamp)}</span>
        </div>
        <div class="text-gray-700 whitespace-pre-line">${escapeHtml(s.content)}</div>
      `;
      submissionList.appendChild(box);
    });
  }

  submitBtn.addEventListener('click', () => {
    const text = submissionTextarea.value.trim();
    if (!text) return;
    const newSub = { id: Date.now().toString(), content: text, timestamp: new Date() };
    submissions.push(newSub);
    submissionTextarea.value = '';
    renderSubmissions();
  });

  /*********************
   * í—¬í¼ í•¨ìˆ˜
   *********************/
  function formatTime(dt) {
    const d = new Date(dt);
    return d.toLocaleTimeString('ko-KR', { hour: '2-digit', minute: '2-digit' });
  }
  function formatShortDate(dt) {
    const d = new Date(dt);
    return d.toLocaleString('ko-KR', { month: 'short', day: 'numeric', hour: '2-digit', minute: '2-digit' });
  }

  // ê°„ë‹¨í•œ XSS ë°©ì§€ìš© ì´ìŠ¤ì¼€ì´í”„
  function escapeHtml(str) {
    return String(str)
      .replaceAll('&', '&amp;')
      .replaceAll('<', '&lt;')
      .replaceAll('>', '&gt;')
      .replaceAll('"', '&quot;')
      .replaceAll("'", '&#39;')
      .replaceAll('\n', '<br>');
  }

  // ì´ˆê¸° íƒ­ í™œì„±í™”
  activateTab('research');
</script>
</body>
</html>